<!-- pelicula.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalle de Película</title>
</head>
<body>
    <h1 id="titulo"></h1>
    <img id="poster" src="" alt="Poster" style="width:300px; margin-bottom:20px;">

    <p><strong>Género:</strong> <span id="genero"></span></p>
    <p><strong>Duración:</strong> <span id="duracion"></span> min</p>
    <p><strong>Director:</strong> <span id="director"></span></p>
    <p><strong>Actores principales:</strong> <span id="actores"></span></p>

    <h3>Sinopsis</h3>
    <p id="descripcion"></p>

    <h3>Sesiones Disponibles</h3>
    <ul id="sesiones"></ul>

    <button onclick="window.location.href='peliculas.html'">⬅️ Volver a la cartelera</button>

    <script>
        const token = localStorage.getItem('token');
        if (!token) {
            alert('Debes iniciar sesión primero.');
            window.location.href = 'index.html';
        }

        async function cargarDetalle() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            const response = await fetch(`/peliculas/${id}`, {
                headers: { 'Authorization': 'Bearer ' + token }
            });
            const data = await response.json();

            document.getElementById('titulo').textContent = data.pelicula.titulo;
            document.getElementById('genero').textContent = data.pelicula.genero;
            document.getElementById('duracion').textContent = data.pelicula.duracion;
            document.getElementById('director').textContent = data.pelicula.director;
            document.getElementById('actores').textContent = data.pelicula.actores_principales;
            document.getElementById('descripcion').textContent = data.pelicula.descripcion;
            document.getElementById('poster').src = data.pelicula.imagen_url;

            const sesionesList = document.getElementById('sesiones');
            sesionesList.innerHTML = data.sesiones.map(sesion => `
                <li>📅 ${sesion.fecha} ⏰ ${sesion.hora} 🎬 ${sesion.sala}</li>
            `).join('');
        }

        cargarDetalle();
    </script>
</body>
</html>
