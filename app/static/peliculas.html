<!-- peliculas.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Cartelera del Cine</title>
</head>
<body>
    <h1>ðŸŽ¬ Cartelera del Cine</h1>
    <button id="logoutBtn">Cerrar sesiÃ³n</button>

    <div id="cartelera"></div>

    <script>
        const token = localStorage.getItem('token');

        if (!token) {
            alert('Debes iniciar sesiÃ³n primero.');
            window.location.href = 'index.html';
        }

        document.getElementById('logoutBtn').onclick = () => {
            localStorage.removeItem('token');
            window.location.href = 'index.html';
        };

        async function cargarPeliculas() {
            const response = await fetch('/peliculas/', {
                headers: { 'Authorization': 'Bearer ' + token }
            });
            const peliculas = await response.json();

            const cartelera = document.getElementById('cartelera');
            cartelera.innerHTML = peliculas.map(pelicula => `
                <div style="margin-bottom: 20px;">
                    <img src="${pelicula.imagen_url}" alt="${pelicula.titulo}" width="200">
                    <h3>${pelicula.titulo} (${pelicula.genero})</h3>
                    <button onclick="verPelicula(${pelicula.id})">Ver detalles</button>
                </div>
            `).join('');
        }

        function verPelicula(id) {
            window.location.href = `pelicula.html?id=${id}`;
        }

        cargarPeliculas();
    </script>
</body>
</html>
